<div class="container">
  <form [formGroup]="form" (ngSubmit)="onFormSubmit()">
  <div class="selector-container">
 <mat-form-field>
   <mat-label>AI Providers</mat-label>
   <mat-select id="ai-provider" [formControlName]="aiProviderControl">
         @for (ai of aiProviders; track ai.id) {
           <mat-option   [value]="ai.name">{{ai.name}}</mat-option>
         }
   </mat-select>
 </mat-form-field>
   </div>
  <div class="selector-container">
 <mat-form-field>
   <mat-label>AI Models</mat-label>
   <mat-select id="model-list" [formControlName]="modelControl" >
     @for (group of currentodel; track group) {
       <mat-optgroup [label]="group.name"
                     [disabled]="group.disabled">
         @for (model of group.model; track model) {
           <mat-option   [value]="model.value">{{model.viewValue}}</mat-option>
         }
       </mat-optgroup>
     }
   </mat-select>
 </mat-form-field>
   </div>

   <!---add model selector ---->
  @if(showSpinner()) {
    <app-loading-spinner></app-loading-spinner>
    }

<div class="input-container">
  <textarea id="prompt-area" matInput [formControlName]="promptControl" placeholder="Type your query here" rows="4" cols="80">

  </textarea>
    <button mat-fab
    matTooltip="Search the prompt"
    [disabled]="showSpinner() || form.invalid || isModelFieldEmpty || isPromptFieldEmpty"
    (submit)="onFormSubmit()"
    color="secondary"
    aria-label="Example icon button with a search icon">
      <mat-icon>search</mat-icon>
    </button>
   @if(!isPromptFieldEmpty) {
    <button mat-fab
    matTooltip="clear the field"
    color="secondary"
    (click)="clearSearch()"
    [disabled]="showSpinner()"
    aria-label="Example icon button with a clear icon">
      <mat-icon>clear</mat-icon>
    </button>
  }

</div>
@for (message of messages(); track message.id) {
  <pre
    class="message"
    [ngClass]="{
      'from-user': message.fromUser,
      generating: message.generating
    }"
    >{{ message.text }}</pre>
}
</form>
<!-- <form #form="ngForm" (ngSubmit)="sendMessage(form, form.value.message)">
  <input
    name="message"
    placeholder="Type a message"
    ngModel
    required
    autofocus
    [disabled]="generatingInProgress()"
  />
  <button type="submit" [disabled]="generatingInProgress() || form.invalid">
    Send
  </button>
</form> -->

<app-error-result [errorMessage]="error"></app-error-result>
<app-search-result [chatHistory]="chatHistory()"></app-search-result>
</div>


